<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<title>MARS FUTURE AI : RED PLANET</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#000;
  font-family:'Orbitron', sans-serif;
}

canvas{
  display:block;
}

/* ===== START SCREEN ===== */
#startScreen{
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at center,#2b0000 0%,#000 100%);
  z-index:10;
  color:#fff;
  pointer-events:auto;
}

#title{
  font-size:clamp(40px,8vw,80px);
  font-weight:900;
  color:#ff3333;
  text-shadow:0 0 20px #f00;
  margin-bottom:40px;
}

#gameStart{
  font-size:24px;
  padding:15px 50px;
  border:2px solid #ff3333;
  color:#ff3333;
  cursor:pointer;
  margin-bottom:20px;
}

#gameStart:hover{
  background:#ff3333;
  color:#000;
}

#bgmBtn{
  font-size:12px;
  color:#aaa;
  cursor:pointer;
}

/* ===== DEBUG HUD ===== */
#debug{
  position:fixed;
  left:10px;
  bottom:10px;
  color:#0f0;
  font-size:11px;
  opacity:0.7;
  pointer-events:none;
}
</style>
</head>

<body>

<div id="startScreen">
  <div id="title">MARS<br>FUTURE AI</div>
  <div id="gameStart">MISSION START</div>
  <div id="bgmBtn">SOUND : OFF</div>
</div>

<canvas id="c"></canvas>
<div id="debug">READY</div>

<script>
"use strict";

/* ===== CANVAS ===== */
const c = document.getElementById("c");
const ctx = c.getContext("2d");
function resize(){
  c.width = innerWidth;
  c.height = innerHeight;
}
addEventListener("resize", resize);
resize();

/* ===== STATE ===== */
let gameRunning = false;
let score = 0;
let nextBossScore = 10000;

const player = {
  x: c.width/2,
  y: c.height*0.8,
  r: 15,
  hp: 100,
  power: 1,
  powerTimer: 0
};

let bullets = [];
let enemies = [];
let enemyBullets = [];

const stars = Array.from({length:80},()=>({
  x:Math.random()*c.width,
  y:Math.random()*c.height,
  s:Math.random()*2+1
}));

/* ===== AUDIO ===== */
const bgm = new Audio("화성.mp3");
bgm.loop = true;
bgm.volume = 0.5;
let bgmEnabled = false;

/* ===== DOM ===== */
const startScreen = document.getElementById("startScreen");
const gameStartBtn = document.getElementById("gameStart");
const bgmBtn = document.getElementById("bgmBtn");
const debugEl = document.getElementById("debug");

/* ===== INPUT ===== */
function move(e){
  const p = e.touches ? e.touches[0] : e;
  player.x = p.clientX;
  player.y = p.clientY;
}

c.addEventListener("mousemove", move);
c.addEventListener("touchmove", e=>{
  move(e);
  e.preventDefault();
},{passive:false});

/* ===== START ===== */
gameStartBtn.addEventListener("click", ()=>{
  startScreen.style.display = "none";
  gameRunning = true;
  c.style.touchAction = "none";

  if(bgmEnabled){
    bgm.play().catch(()=>{});
  }
});

bgmBtn.addEventListener("click", ()=>{
  bgmEnabled = !bgmEnabled;
  bgmBtn.innerText = bgmEnabled ? "SOUND : ON" : "SOUND : OFF";
  if(!bgmEnabled){
    bgm.pause();
    bgm.currentTime = 0;
  }
});

/* ===== SHOOT ===== */
setInterval(()=>{
  if(!gameRunning) return;

  bullets.push({x:player.x,y:player.y-20,v:12,dmg:20});

  if(player.power>1){
    bullets.push({x:player.x-15,y:player.y,v:12,dmg:20});
    bullets.push({x:player.x+15,y:player.y,v:12,dmg:20});
  }
},180);

/* ===== ENEMY ===== */
setInterval(()=>{
  if(!gameRunning) return;

  enemies.push({
    x:Math.random()*c.width,
    y:-30,
    r:18,
    hp:40,
    speed:4
  });
},450);

/* ===== BOSS ===== */
let boss = null;
function spawnBoss(){
  boss = {x:c.width/2,y:120,r:50,hp:5000,cd:0};
}

/* ===== LOOP ===== */
function loop(){
  try{
    ctx.fillStyle="#000";
    ctx.fillRect(0,0,c.width,c.height);

    ctx.fillStyle="#fff";
    stars.forEach(s=>{
      s.y+=s.s;
      if(s.y>c.height) s.y=0;
      ctx.fillRect(s.x,s.y,s.s,s.s);
    });

    if(!gameRunning){
      requestAnimationFrame(loop);
      return;
    }

    if(score>=nextBossScore && !boss){
      spawnBoss();
      nextBossScore+=10000;
    }

    bullets = bullets.filter(b=>{
      b.y-=b.v;
      enemies.forEach(e=>{
        if(Math.hypot(b.x-e.x,b.y-e.y)<e.r){
          e.hp-=b.dmg;
          b.y=-999;
        }
      });
      if(boss && Math.hypot(b.x-boss.x,b.y-boss.y)<boss.r){
        boss.hp-=b.dmg;
        b.y=-999;
      }
      return b.y>0;
    });

    enemies = enemies.filter(e=>{
      e.y+=e.speed;
      if(e.hp<=0){ score+=100; return false; }
      return e.y<c.height+50;
    });

    if(boss){
      boss.x+=Math.sin(Date.now()*0.002)*4;
      boss.cd--;
      if(boss.cd<=0){
        for(let i=0;i<10;i++){
          const a=i*Math.PI/5;
          enemyBullets.push({
            x:boss.x,
            y:boss.y,
            vx:Math.cos(a)*5,
            vy:Math.sin(a)*5
          });
        }
        boss.cd=50;
      }
      if(boss.hp<=0){ boss=null; score+=3000; }
    }

    enemyBullets = enemyBullets.filter(eb=>{
      eb.x+=eb.vx;
      eb.y+=eb.vy;
      return eb.x>0&&eb.x<c.width&&eb.y>0&&eb.y<c.height;
    });

    /* DRAW PLAYER */
    ctx.save();
    ctx.tr
